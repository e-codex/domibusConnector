= receive business message from gateway

== extends
link:receive_message_from_gateway.html[receive message from gateway]

== process steps

|===
| step | description | parameters | returns | on success | on fail | module responsibility

|Find Domain
a|
* Is there a referenced message?
* Are there messages for this conversation already?
* in case of multi-tenancy: which domain is sent by the gateway?
* default domain.
|inherited
|inherited
|inherited
|Create and send RELAY_REMMD_REJECTION
|inherited

|Map to BusinessModel
|inherited
|inherited
|inherited
|inherited
|Create and send RELAY_REMMD_REJECTION
|inherited

|Persist MSG
|inherited
|inherited
|inherited
|inherited
|Create and send RELAY_REMMD_REJECTION
|inherited

|Write to Storage
|inherited
|inherited
|inherited
|inherited
|Create and send RELAY_REMMD_REJECTION
|inherited

|Create and send RELAY_REMMD_REJECTION
|If possible, create RELAY_REMMD_REJECTION and send it as new WS message to gateway.
This is not treated as connector message!
|DomibusConnectorMessage
|result
|cleanUp
|cleanUp
|Controller