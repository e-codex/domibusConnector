
ifndef::basepath[]
:basepath: ../../../../
endif::basepath[]

ifndef::header[]
include::{basepath}/doc/header.adoc[]
endif::header[]

= Incoming Business Message

== Trigger
This workflow is started by the workflow engine.

== Preconditions

* Message has already been received and saved
* Workflow has been assigned
* Business Domain has been assigned

== Process



This workflow consists of the following activities:

[plantuml,outgoing_business_message,format=svg]
----
@startuml

title Outgoing Business Message Workflow

start

:New OutgoingBusinessMessage Workflow started;

:Create BusinessMessage;

:Validate/Create/Complete P-Modes;

: [optional/discussion] Lookup Gateway;

:Validate eCodex Container;
if () then (validation/creation has failed)
:Create SUBMISSION_REJECTION;
:process Evidence for BusinessMessage;
:trigger send back of SUBMISSION_REJECTION;
end
else (validation/creation OK)

:Create Evidence SUBMISSION_ACCEPTANCE;
:append SUBMISSION_ACCEPTANCE to message;

endif

:deliver Message to GatewayLink;

stop

@enduml
----


[plantuml,outgoing_business_message_sent_event,format=svg]
----
@startuml

title Outgoing Business Message Workflow Sent Event

start

:Sent Event received for outgoing business message;

if () then (successfully sent)
:process SUBMISSION_ACCEPTANCE for business message;
else (error from gw)
:create SUBMISSION_REJECTION;
:process SUBMISSION_REJECTION for business message;
:trigger send back of SUBMISSION_REJECTION;
endif

stop

@enduml
----
