<?xml version="1.0" encoding="UTF-8"?>
<ui:composition 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
      			xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets">


	<ui:param name="title" value="WebAdmin - Connector Party Table"/>
	
<!--     <ui:define name="content"> -->
    
    <f:event type="preRenderView" listener="#{connectorPartiesTableBean.init}" />
         
	
         
         
 	<h:form enctype="multipart/form-data" id="partyForm"> 
 	
 		<p:dataTable id="partyTable" var="party" value="#{connectorPartiesTableBean.partyList}" 
 			selection="#{connectorPartiesTableBean.selectedParties}" 
 			rowKey="#{party}"
 			resizableColumns="true"
 			scrollable="true"
 			tableStyle="table-layout: auto; "
 			table-layout="auto"
 			
			>

				<f:facet name="header" >
					<p:panelGrid>
						<p:row>
							<p:column styleClass="ui-widget-header">

									<p:commandButton id="showCreatePartyDialog"    
									 					ajax="true"          	
									            		value="Create new" 
														update="createEditPartyDialog partyEditForm"
														style="float:left;"
									            		actionListener="#{connectorPartiesTableBean.createNewParty}"
									            	 	onsuccess="PF('createEditPartyDialog').show()" >	
							        		<f:setPropertyActionListener target="#{connectorPartiesTableBean.editDialogTitle}" value="Create Connection Party" />
											<f:setPropertyActionListener target="#{connectorPartiesTableBean.editDialogConfirmButtonText}" value="Create" />
									</p:commandButton>
			   
							</p:column>
							<p:column styleClass="ui-widget-header" colspan="2" style="border:none;">
								<h:outputText value=" domibusConnector configured Parties" />
							</p:column>

							<p:column styleClass="ui-widget-header"></p:column>
						</p:row>
					</p:panelGrid>
				
				</f:facet>


				<p:column headerText="" selectionMode="multiple" />
        
 		    
        	<p:column headerText="Party ID">
		        <h:outputText value="#{party.partyId}"/>  
        	</p:column>
            
            <p:column headerText="Party ID Type">
                <h:outputText value="#{party.partyIdType}" />
            </p:column>
            
            <p:column headerText="Role">
                <h:outputText value="#{party.role}" />
            </p:column>
            
            <p:column>
				<p:commandButton
							icon="ui-icon-pencil" 
							title="edit"
							action="#{connectorPartiesTableBean.editParty}"  
							ajax="true" 
							onsuccess="PF('createEditPartyDialog').show()" 
							update="createEditPartyDialog partyEditForm" >
				 	<f:setPropertyActionListener target="#{connectorPartiesTableBean.party}" value="#{party}" />
				 	<f:setPropertyActionListener target="#{connectorPartiesTableBean.editDialogTitle}" value="Edit Connection Party" />
				 	<f:setPropertyActionListener target="#{connectorPartiesTableBean.editDialogConfirmButtonText}" value="Save" />
				</p:commandButton>
            </p:column>
        
		<f:facet name="footer">
            <!--  <p:commandButton process="checkboxDT" update=":form:multiCarDetail" icon="ui-icon-search" value="View" oncomplete="PF('multiCarDialog').show()" /> 
            actionListener="#{connectorPartiesTableBean.deleteSelectedParties}"
            -->
            <p:toolbar name="header"> 
				<f:facet name="left">
            		<p:commandButton id="deleteSelectedPartiesButton" 
            			process="partyTable"
            			update=":partyDialogForm:partyDelete"
            			value="Delete Selected" oncomplete="PF('multiPartyDialog').show()" />
            	</f:facet>
            </p:toolbar>
        </f:facet>

    </p:dataTable> 	 
    
 	</h:form> 	
 	
 	<p:dialog appendTo="@(body)" header="For deletion selected parties:" widgetVar="multiPartyDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" width="520" dynamic="true" >
 		<h:form id="partyDialogForm"> 	 			
	        <p:outputPanel id="partyDelete" style="text-align:center;">
	            <ui:repeat value="#{connectorPartiesTableBean.selectedParties}" var="party">	            	
	                <h:outputText value="#{party.partyId} - #{party.partyIdType} - #{party.role}" style="display:block"/>
	            </ui:repeat>            
	            <p:commandButton id="confirmDeleteSelectedPartiesButton" actionListener="#{connectorPartiesTableBean.confirmDeleteSelectedParties}" ajax="false" value="Delete" />
	            <p:commandButton id="abbortDeleteSelectedPartiesButton" ajax="false" value="Cancel" /> <!-- TODO: Styling, ordering -->             
	        </p:outputPanel>
        </h:form>
    </p:dialog>
 	
  	
  	<!--  TODO: header variabel machen... -->
  	
 		<p:dialog appendTo="@(body)"  widgetVar="createEditPartyDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" width="50em" >
 				
 			<f:facet name="header">
 				<h:outputText id="createEditPartyDialog" value="#{connectorPartiesTableBean.editDialogTitle}" />
 			</f:facet>
 			<h:form id="partyEditForm">
 			<p:panelGrid columns="2" layout="grid" width="auto" >
 				<h:outputLabel for="partyEditPartyId" value="Party ID" />
 				<!--  changing pk components (partyId, role) is not allowed! -->
 				<p:inputText id="partyEditPartyId"  value="#{connectorPartiesTableBean.party.partyId}" size="45" disabled="#{not(connectorPartiesTableBean.createNewPartyMode)}" /> 
 					
				<h:outputLabel for="partyEditPartyIdType" value="Party ID Type"  />
				<p:inputText id="partyEditPartyIdType" value="#{connectorPartiesTableBean.party.partyIdType}" size="45" />
				
				<h:outputLabel for="partyEditPartyRole" value="Role" />
				<p:inputText id="partyEditPartyRole" value="#{connectorPartiesTableBean.party.role}" size="45" disabled="#{not(connectorPartiesTableBean.createNewPartyMode)}" />
				 					 					 					
 			</p:panelGrid>
 			<!--  TODO: Error Message Feld hier einbauen -->
 			
 			<p:commandButton id="confirmCreateParty" actionListener="#{connectorPartiesTableBean.saveParty}" ajax="false" value="#{connectorPartiesTableBean.editDialogConfirmButtonText}" />
 			
 			<p:commandButton id="cancelCreateParty" ajax="false" value="Cancel" >
 				<!--  setzt party auf null -->
 				<f:setPropertyActionListener target="#{connectorPartiesTableBean.party}" value="#{doesnotexist}" /> 			
 			</p:commandButton>
 			
 
 		
 	</h:form> 	
 	</p:dialog>
 	

</ui:composition>
