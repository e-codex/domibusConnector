<assembly>
  <id>holodeck</id>
  <formats>
    <format>zip</format>
    <format>dir</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>

  <fileSets>

    <!-- ==================== Copying Tomcat Folder ================= -->
    <fileSet>
      <directory>${tomcat-home}</directory>
      <outputDirectory>${holodeck.build.dir}/server/</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <excludes>
        <exclude>logs/*.log*</exclude>
        <exclude>conf/Catalina/localhost/*.xml</exclude>
        <exclude>work/Catalina/localhost/**</exclude>
      </excludes>
    </fileSet>

    <!-- ==================== Copying Axis2 Folder ================= -->
    <fileSet>
      <directory>${axis2-home}</directory>
      <outputDirectory>${holodeck.build.dir}/msh/</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <excludes>
        <exclude>WEB-INF/web.xml</exclude>
        <exclude>WEB-INF/conf/axis2.xml</exclude>
        <exclude>WEB-INF/classes/**</exclude>
      </excludes>
    </fileSet>
    
    <!-- ==================== Copying DB Scripts ================= -->
    <fileSet>
      <directory>${db-scripts-home}</directory>
      <outputDirectory>${holodeck.build.dir}/msh/db-scripts</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
    </fileSet>

    <!-- ================= Copying ebms3 compiled classes =============== -->
    <fileSet>
      <directory>../holodeck-ebms3/target/classes</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**/*.class</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ===================== Copying ebms3 meta-inf ==================== -->
    <fileSet>
      <directory>../holodeck-ebms3/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/modules/holodeck-ebms3</outputDirectory>
      <includes>
        <include>META-INF/module.xml</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- =============== Copying ebms3 module config files ============== -->
    <fileSet>
      <directory>../holodeck-ebms3/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/config</outputDirectory>
      <excludes>
        <exclude>Submitted_Messages/**</exclude>
        <exclude>META-INF/**</exclude>
      </excludes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- =============== Copying ebms3 send messages ==================== -->
    <fileSet>
      <directory>../holodeck-ebms3/src/main/resources/Submitted_Messages</directory>
      <outputDirectory>${holodeck.build.dir}/store/send</outputDirectory>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ====================== Copying derby databases ==================== -->
    <fileSet>
      <directory>../../target/derby</directory>
      <outputDirectory>${holodeck.build.dir}/store/derby</outputDirectory>
    </fileSet>
    
    <!-- ================= Copying security compiled classes =============== -->
    <fileSet>
      <directory>../holodeck-security/target/classes</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**/*.class</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- =============== Copying security module config files ============== -->
    <fileSet>
      <directory>../holodeck-security/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/config</outputDirectory>
      <includes>
        <include>keys/*</include>
        <include>policies/*</include>
        <include>security-config.xml</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ===================== Copying security meta-inf ==================== -->
    <fileSet>
      <directory>../holodeck-security/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/modules/holodeck-security</outputDirectory>
      <includes>
        <include>META-INF/module.xml</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ================= Copying reliability compiled classes =============== -->
    <fileSet>
      <directory>../holodeck-reliability/target/classes</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**/*.class</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ===================== Copying reliability meta-inf ==================== -->
    <fileSet>
      <directory>../holodeck-reliability/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/modules/holodeck-reliability</outputDirectory>
      <includes>
        <include>META-INF/module.xml</include>
        <include>Storage_Folder</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ================= Copying logging compiled classes =============== -->
    <fileSet>
      <directory>../holodeck-logging/target/classes</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**/*.class</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ===================== Copying logging meta-inf ==================== -->
    <fileSet>
      <directory>../holodeck-logging/src/main/resources/</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/modules/holodeck-logging</outputDirectory>
      <includes>
        <include>META-INF/module.xml</include>
        <include>Storage_Folder</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ==================== Copying common compiled classes ================== -->
    <fileSet>
      <directory>../holodeck-common/target/classes</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**/*.class</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ===================== Copying log4j and persistence.xml =============== -->
    <fileSet>
      <directory>src/main/resources</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ======================== Copying msh service ========================== -->
    <fileSet>
      <directory>src/main/conf/msh</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/services/msh</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <!-- ======================== Copying wsrm service ========================== -->
    <fileSet>
      <directory>src/main/conf/wsrm</directory>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/services/wsrm</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!-- ==================== Copying Site Documentation ======================== -->
    <fileSet>
      <directory>${basedir}/../../target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/</outputDirectory>
      <includes>
        <include>apidocs/**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <fileSet>
      <directory>${basedir}/../documentation/target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/</outputDirectory>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <fileSet>
      <directory>${basedir}/../documentation/src/site/resources</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/</outputDirectory>
      <includes>
        <include>css/**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>

    <!--
    <fileSet>
      <directory>${basedir}/target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/user-guide/</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <fileSet>
      <directory>${basedir}/../../target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/dev-guide/</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <fileSet>
      <directory>${basedir}/../holodeck-embs3/target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/dev-guide/modules/holodeck-ebms3</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <fileSet>
      <directory>${basedir}/../holodeck-reliability/target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/dev-guide/modules/holodeck-reliability</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    <fileSet>
      <directory>${basedir}/../holodeck-security/target/site</directory>
      <outputDirectory>${holodeck.build.dir}/msh/docs/dev-guide/modules/holodeck-security</outputDirectory>
      <includes>
        <include>**</include>
      </includes>
      <useDefaultExcludes>true</useDefaultExcludes>
    </fileSet>
    -->


	   <!-- ================= Backend files =============== -->
	   <!-- ================= Copying backend compiled classes =============== -->
	   <fileSet>
	     <directory>../holodeck-backend/target/classes</directory>
	     <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
	     <includes>
	       <include>**/*.class</include>
	       <include>**/*.xsb</include>
	     </includes>
	     <useDefaultExcludes>true</useDefaultExcludes>
	   </fileSet>
	   <!-- ===================== Copying backend meta-inf ==================== -->
	   <fileSet>
	     <directory>../holodeck-backend/src/main/resources/</directory>
	     <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/modules/holodeck-backend</outputDirectory>
	     <includes>
	       <include>META-INF/module.xml</include>
	     </includes>
	     <useDefaultExcludes>true</useDefaultExcludes>
	   </fileSet>
	    <!-- ======================== Copying backend service ========================== -->
	    <fileSet>
	      <directory>src/main/conf/backend</directory>
	      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/services/backend</outputDirectory>
	      <includes>
	        <include>**</include>
	      </includes>
	      <useDefaultExcludes>true</useDefaultExcludes>
	    </fileSet>
	   <!-- ===================== Copying backend ddl ==================== -->
	   <fileSet>
	     <directory>src/main/conf</directory>
	     <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
	     <includes>
	       <include>backend-schema-mysql.ddl</include>
	     </includes>
	     <useDefaultExcludes>true</useDefaultExcludes>
	   </fileSet>
	   <!-- ===================== Copying backend spring config ==================== -->
	   <fileSet>
	     <directory>../holodeck-backend/src/main/resources/</directory>
	     <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/classes</outputDirectory>
	     <includes>
	       <include>backendApplicationContext.xml</include>
	     </includes>
	     <useDefaultExcludes>true</useDefaultExcludes>
	   </fileSet>
  </fileSets>
  
  <!-- ========== Copying axis2.xml, holodeck.xml, web.xml and derby DB =========== -->
  <files>
    <file>
      <source>${axis2.xml}</source>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/conf/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/web.xml</source>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/applicationContext.xml</source>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/holodeck.xml</source>
      <outputDirectory>${holodeck.build.dir}/server/conf/Catalina/localhost/</outputDirectory>
    </file>
    <file>
      <source>../holodeck-reliability/src/main/resources/reliability-config.xml</source>
      <outputDirectory>${holodeck.build.dir}/config</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/start-derby.bat</source>
      <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/stop-derby.bat</source>
      <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/ebms3-schema-mysql.ddl</source>
      <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
    </file>
    <file>
      <source>src/main/conf/reliability-schema-mysql.ddl</source>
      <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
    </file>
    <!-- Copy the generated ddl from the source to the destination folder. The other files ddl files (ebms3, reliablity) are static!!! -->
    <file>
      <source>../holodeck-logging/target/hibernate3/sql/logging-schema-mysql.ddl</source>
      <outputDirectory>${holodeck.build.dir}/store/derby/</outputDirectory>
    </file>
  </files>

  <!-- ================== Copying dependency libraries ========================= -->
  <dependencySets>
    <dependencySet>
      <scope>runtime</scope>
      <outputDirectory>${holodeck.build.dir}/msh/WEB-INF/lib</outputDirectory>
      <excludes>
        <exclude>*:servlet-api:*</exclude>
        <exclude>*:bcprov-jdk15:*</exclude>
        <exclude>*:commons-codec:1.2:*</exclude>
        <exclude>*:commons-collections:3.1:*</exclude>
      </excludes>
    </dependencySet>
  </dependencySets>

  <!-- ================== Copying Flex App ========================= --> 
  <fileSet>
    <directory>../holodeck-ui/target/index-holodeck.dir/msh</directory>
    <outputDirectory>${holodeck.build.dir}/msh/</outputDirectory>
    <!--useDefaultExcludes>true</useDefaultExcludes-->
  </fileSet>

</assembly>
